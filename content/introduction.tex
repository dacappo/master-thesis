\chapter{Introduction}
\label{cha:introduction}
This first chapter outlines the underlying motivation for the investigation of NoSQL injection, defines the objectives in scope of this work and gives a look forward to the achieved academic contributions. Lastly, the structure of the thesis is elucidated.

\section{Motivation}
In the last decade many new challenges, such as big data, social media and the internet of things, changed the way we build applications. More and more devices got connected to the internet and started producing huge amounts of unstructured data. This new situation demanded for highly scalable, always available systems for large numbers of concurrent and globally distributed users. The by then prevailing relational databases did not meet the upcoming requirements and reached their limits facing the enormous amounts of data. Given these circumstances, the generation of NoSQL databases emerged. With a non-relational approach in common, these databases provided a solution for the given challenges. Flexible handling of unstructured and semi-structured data originating from different sources in combination with powerful horizontal scaling abilities lead to the break through of NoSQL technologies. Since then, these databases were deployed in many application stacks and serve millions of users every day. Google uses NoSQL solutions as a part of their compute engine, Facebook adapted its storage engine for NoSQL integration and SAP selected NoSQL technologies for the core content management of its PaaS offering. These and many more examples leave no doubt that this new generation of databases offers notable advantages for modern applications, but do they provide security? When innovative concepts find their way to production, the security aspect is often neglected. Especially a well-known attack vector against relational databases - SQL injection - was not taken into account for NoSQL applications. Regarding injection, the prevalent opinion is that we are not building queries from strings, so we do not have to worry about injection vulnerabilities. This attitude may rest upon the few known attack vectors for NoSQL injection against specific platforms. However, the launch of the social media platform Diaspora showed that NoSQL injection is an serious issue. This raises the question, whether the known examples were individual cases or NoSQL injection presents a general threat for our modern applications. Since NoSQL comprises a variety of databases with slightly different concepts and query languages, a versatile attack surface for injection is given. All the same time, only little effort has been made to discover potential injection vulnerabilities. On account of this prevailing situation, the subject of NoSQL injection has to be investigated comprehensively and in greater detail.

\section{Objective}
This thesis aims to give an encompassing overview of injection attacks against NoSQL databases. A precise understanding of a system's architecture is vital to analyze potential risks. NoSQL presents a relatively new and unexplored kind of attack. Therefore, a clear definition of the class of attacks has to be made. Since NoSQL technologies lead to changes of typical system structures, also the existing attacker models have to be reevaluated. The first objective of this thesis covers these subjects: \\

\textbf{Objective 1:} \textit{Detailed definition of NoSQL injection and the corresponding attacker models.} \\

Outgoing from these definitions concrete injection vulnerabilities in NoSQL databases has to be searched. Previous studies concentrated on single databases in combination with a specific application layer. In contrast to these published attack vectors, a more holistic approach is needed in order to give a widespread overview of the topic. On that account the most prevalent NoSQL technology stacks have to be selected and investigated with regard to injection vulnerabilities. For this reason, objective 2 of this work is defined as follows: \\

\textbf{Objective 2:} \textit{Investigation of a selected group of technology stacks for injection vulnerabilities.} \\

With the results of the investigation the vulnerabilities examined for their underlying problems. A differentiation between conceptional and implementation problems is an important aspect of this step. Vulnerabilities originating from implementation flaws can easily be fixed when reported, whereas conceptional problems are hard to solve in most cases. Conceptional vulnerabilities are based on the underlying design of the database. Therefore, objective 3 covers the classification as follows: \\

\textbf{Objective 3:} \textit{Classification of NoSQL injection vulnerabilities according to the underlying design problem.} \\

The elaboration of these three objectives should allow a general overview of NoSQL injection and provide an outline of the threads modern applications have to face with this class of attacks.


\section{Contributions}

The main contributions of this thesis concerning NoSQL application security are:
\begin{description}
\item [Injection Attacks] NoSQL injection vulnerabilities are not a database oder application layer specific problem. Therefore, this thesis reveals new injection vectors for multiple NoSQL databases in combination with common application layers. With this broad range of investigated technology stacks, it is shown, that NoSQL injection is a general issue across non-relational databases.
\item [Attacker Models] Despite parallels to SQL injection attacks, the existing attacker models are not sufficient considering NoSQL injection. Since NoSQL databases are created with the aim to handle huge amounts of unstructured data from several sources, format restrictions are low. These circumstances may allow insertions of attacker controlled data from external sources. On account of this, an additional attacker model is introduced and exemplary attacks are presented to cover these new conditions.
\item [Injection Prevention] The mitigation of NoSQL injection is hard to ensure, since the data and therefore the requests assume various shapes across databases. In order to reduce the risk of injection attacks, this thesis breaks down known injection vectors to the underlying design problems. On basis of these a new database driver design is presented, that is resistant to known injection attacks.
\end{description}

\section{Structure}
This thesis is  structured as follows: In Chapter 2 an overview of fundamental technologies of the thesis is given. Used protocols, investigated databases and the necessary security topics are outlined in this part. Chapter 3 gives an introduction to the concept of NoSQL injection as well as corresponding attacker models. Subsequently, the in scope of this thesis discovered injection vectors are presented in chapter 4. A diverse technology stacks are addressed in this part. Chapter 5 classifies the found attack vectors based on their underlying problem. Based on this classification, chapter 6 presents a new approach for NoSQL injection mitigation. Within chapter 7 the presented solution is evaluated with real world applications. A comparison of this thesis to related publications is given in chapter 8. The last part, chapter 9, discusses the results of this work and gives a potential outlook for future work on the subject of NoSQL injection.f